# Использование tensorboard для визуализации обучения модели на Pytorch.

Для примера, модель обучается на датасете рукописных цифр MNIST. 
Чтобы запихнуть данные в tensorboard нужно создать объект класса SummaryWriter(), туда будут записываться данные для визуализации. Например:
```
writer = SummaryWriter(f'runs/MNIST/MiniBatchSize {batch_size} LR {learning_rate}')
writer.add_graph(model, images.to(device)) # визуализация структуры модели
writer.add_histogram('fc1', model.fc1.weight) # визуализация весов
```
## С помощью TensorBoard можно смотреть:
1) Графики точности и функции потерь при разных парамаметрах (например здесь разные batch sizes и learning rates):
<img width="1370" alt="Снимок экрана 2021-08-11 в 23 57 19" src="https://user-images.githubusercontent.com/55971827/129325469-56fe3037-0aaa-4e09-9e48-7eaef22bb11a.png">
2) Визуализацию комбинаций этих параметров для подбора лучшей комбинации:
<img width="1368" alt="Снимок экрана 2021-08-12 в 00 13 11" src="https://user-images.githubusercontent.com/55971827/129325761-f2925b5f-7c21-467d-af53-12ee09c2bda7.png">
3) Распределение весов (здесь веса последнего fc слоя, видно, что они меняются, значит модель обучается):
<img width="1367" alt="Снимок экрана 2021-08-12 в 00 41 18" src="https://user-images.githubusercontent.com/55971827/129325930-e4655a9a-00f5-43a9-9e50-5e73dc467870.png">
4) Проектирование картинок на пространство с помощью встроенного проектора в TensorBoard Embedding Projector, который пока у меня не запускается из-за конфликта версий либ, который мне пока лень устранить :)

## Как запускать
Сначала запускаете проект .py, затем после его завершения в терминале в директории проекта пишем:
```
tensorboard --logdir runs 
```
После чего в терминале появится ссылка вроде такой: http://localhost:6006/

Перед каждым новым запуском желательно удалять содерживмое папки "/runs", дабы данные не стакались и не получилось каши)


 


